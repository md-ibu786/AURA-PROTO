---
phase: 01-foundation-state
plan: 01-01
type: execute
---

<objective>
Add mobile menu state to the Zustand explorer store and create a reusable mobile breakpoint hook.

Purpose: All mobile-responsive components need to know (a) whether the viewport is mobile-sized and (b) whether the mobile menu is open. This plan creates the shared state and detection infrastructure that all subsequent phases depend on.
Output: Updated useExplorerStore.ts with mobileMenuOpen state, and a new useMobileBreakpoint.ts hook.
</objective>

<execution_context>
@~/.claude/skills/create-plans/workflows/execute-phase.md
@~/.claude/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/mobile-responsive/ROADMAP.md
@frontend/MOBILE_RESPONSIVE_PLAN.md
@frontend/src/stores/useExplorerStore.ts
@frontend/src/types/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add mobileMenuOpen state to useExplorerStore</name>
  <files>frontend/src/stores/useExplorerStore.ts</files>
  <action>
  Add the following to the ExplorerState interface and store implementation:

  1. In `ExplorerState` interface, add:
     - `mobileMenuOpen: boolean;`
     - `setMobileMenuOpen: (open: boolean) => void;`

  2. In the store initial state, add:
     - `mobileMenuOpen: false,`

  3. Add the action implementation:
     - `setMobileMenuOpen: (open) => set({ mobileMenuOpen: open }),`

  4. In the `reset()` function, add `mobileMenuOpen: false` to the reset object.

  5. In the `navigateTo` action, add `mobileMenuOpen: false` to the set() call â€” this ensures the sidebar auto-closes when navigating on mobile.

  6. In the `navigateUp` action (both branches), add `mobileMenuOpen: false` to the set() calls.

  7. In the `setCurrentPath` action, add `mobileMenuOpen: false` to the set() call.

  Do NOT change any existing functionality. Only add the new state and integrate closing behavior into existing navigation actions.
  </action>
  <verify>Run `cd frontend && npx tsc --noEmit` to confirm no type errors</verify>
  <done>mobileMenuOpen state exists in store, auto-closes on navigation, reset() clears it, type check passes</done>
</task>

<task type="auto">
  <name>Task 2: Create useMobileBreakpoint hook</name>
  <files>frontend/src/hooks/useMobileBreakpoint.ts</files>
  <action>
  Create a new file `frontend/src/hooks/useMobileBreakpoint.ts` that exports a custom hook:

  ```typescript
  // useMobileBreakpoint.ts
  // Custom hook to detect mobile viewport using matchMedia API

  // Uses window.matchMedia('(max-width: 768px)') to reactively detect
  // viewport size changes. Returns a boolean indicating if the current
  // viewport is at or below the mobile breakpoint (768px).

  // @see: stores/useExplorerStore.ts - For mobileMenuOpen state
  // @note: 768px matches the CSS breakpoint in explorer.css
  ```

  Implementation:
  1. Import `useState` and `useEffect` from React
  2. Define `MOBILE_BREAKPOINT = 768` as a constant
  3. Create and export `useMobileBreakpoint` function (named export, no default)
  4. Inside: use `window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT}px)`)` to create a MediaQueryList
  5. Initialize state with `mediaQuery.matches`
  6. Use `useEffect` to add event listener for `change` events on the MediaQueryList
  7. Clean up listener on unmount
  8. Return `isMobile` boolean
  9. Also export `MOBILE_BREAKPOINT` constant for use elsewhere

  Use `addEventListener('change', handler)` NOT the deprecated `addListener()`.
  </action>
  <verify>Run `cd frontend && npx tsc --noEmit` to confirm no type errors</verify>
  <done>useMobileBreakpoint hook exists, exports isMobile boolean and MOBILE_BREAKPOINT constant, type check passes</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `cd frontend && npx tsc --noEmit` passes with zero errors
- [ ] `useExplorerStore` has `mobileMenuOpen` state and `setMobileMenuOpen` action
- [ ] `useMobileBreakpoint` hook correctly detects viewport changes
- [ ] Navigation actions auto-close the mobile menu
- [ ] No existing functionality broken
</verification>

<success_criteria>
- Both files type-check cleanly
- Store state integrates with existing navigation flow
- Hook uses modern matchMedia API (not deprecated addListener)
- All exports are named (no default exports)
</success_criteria>

<output>
After completion, create `.planning/mobile-responsive/phases/01-foundation-state/01-01-SUMMARY.md`
</output>
