---
phase: 02-sidebar-mobile
plan: 02-01
type: execute
---

<objective>
Transform Sidebar.tsx into a mobile-friendly slide-in overlay with backdrop and close button.

Purpose: The sidebar is the highest-impact mobile change â€” it currently takes 280px of a 375px mobile screen. This plan makes it a slide-in overlay that appears on demand, with a close button and backdrop for dismissal.
Output: Updated Sidebar.tsx with mobile overlay behavior, backdrop element, and close button.
</objective>

<execution_context>
@~/.claude/skills/create-plans/workflows/execute-phase.md
@~/.claude/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/mobile-responsive/ROADMAP.md
@frontend/src/components/layout/Sidebar.tsx
@frontend/src/stores/useExplorerStore.ts
@frontend/src/hooks/useMobileBreakpoint.ts
@frontend/src/styles/explorer.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add mobile overlay behavior to Sidebar.tsx</name>
  <files>frontend/src/components/layout/Sidebar.tsx</files>
  <action>
  Update Sidebar.tsx with the following changes:

  1. Import the new hook and icon:
     ```typescript
     import { useMobileBreakpoint } from '../../hooks/useMobileBreakpoint';
     import { X } from 'lucide-react';  // Add X to existing lucide imports
     ```

  2. Inside the component, add:
     ```typescript
     const { mobileMenuOpen, setMobileMenuOpen } = useExplorerStore();
     const isMobile = useMobileBreakpoint();
     ```

  3. Update the `<aside>` element to conditionally add the `mobile-open` class:
     ```tsx
     <aside className={`explorer-sidebar ${isMobile && mobileMenuOpen ? 'mobile-open' : ''}`}>
     ```

  4. Add a close button in the sidebar header that is ONLY visible on mobile. Modify the sidebar-header div to include:
     ```tsx
     <div className="sidebar-header">
         <div className="flex items-center gap-sm" style={{ justifyContent: 'space-between', width: '100%' }}>
             <div className="flex items-center gap-sm">
                 <FolderTree size={18} className="text-accent" />
                 <span className="sidebar-title">AURA</span>
             </div>
             {isMobile && (
                 <button
                     onClick={() => setMobileMenuOpen(false)}
                     className="nav-btn"
                     title="Close menu"
                 >
                     <X size={18} />
                 </button>
             )}
         </div>
     </div>
     ```

  5. Add the backdrop element AFTER the `<aside>` closing tag, inside a React Fragment wrapping both:
     ```tsx
     <>
         {isMobile && (
             <div
                 className={`sidebar-backdrop ${mobileMenuOpen ? 'visible' : ''}`}
                 onClick={() => setMobileMenuOpen(false)}
             />
         )}
         <aside className={`explorer-sidebar ${isMobile && mobileMenuOpen ? 'mobile-open' : ''}`}>
             {/* existing sidebar content */}
         </aside>
     </>
     ```

  IMPORTANT: The backdrop must come BEFORE the sidebar in the DOM so the sidebar renders on top (higher z-index). Both the backdrop (z-index: 99) and sidebar (z-index: 100) are defined in the CSS from Plan 01-02.

  Do NOT change any existing sidebar functionality (tree, create button, user info, upload dialog). Only wrap with fragment, add backdrop, add close button, and add mobile-open class logic.
  </action>
  <verify>Run `cd frontend && npx tsc --noEmit` to confirm no type errors</verify>
  <done>Sidebar renders backdrop on mobile, adds mobile-open class when mobileMenuOpen is true, close button visible on mobile only, type check passes</done>
</task>

<task type="auto">
  <name>Task 2: Add mobile close button CSS</name>
  <files>frontend/src/styles/explorer.css</files>
  <action>
  Inside the existing `@media (max-width: 768px)` block (added in Plan 01-02), add styles for the mobile close button:

  ```css
      /* Mobile sidebar close button */
      .sidebar-header {
          display: flex;
          align-items: center;
      }

      .sidebar-header .nav-btn {
          margin-left: auto;
      }
  ```

  This ensures the close button is right-aligned in the sidebar header on mobile.
  </action>
  <verify>Run `cd frontend && npm run build` to verify CSS is valid and build succeeds</verify>
  <done>Close button styles added inside mobile media query, build passes</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `cd frontend && npx tsc --noEmit` passes
- [ ] `cd frontend && npm run build` passes
- [ ] Sidebar has mobile-open class logic
- [ ] Backdrop renders on mobile
- [ ] Close button visible only on mobile
- [ ] Desktop sidebar behavior unchanged
</verification>

<success_criteria>
- Sidebar slides in from left on mobile when mobileMenuOpen is true
- Backdrop appears behind sidebar and closes it on click
- Close X button visible in sidebar header on mobile
- Desktop layout completely unaffected
- No type errors or build errors
</success_criteria>

<output>
After completion, create `.planning/mobile-responsive/phases/02-sidebar-mobile/02-01-SUMMARY.md`
</output>
