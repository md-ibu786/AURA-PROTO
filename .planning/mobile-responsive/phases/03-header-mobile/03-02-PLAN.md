---
phase: 03-header-mobile
plan: 03-02
type: execute
---

<objective>
Collapse the search bar to an icon-toggle on mobile and adjust view toggle spacing.

Purpose: The search bar is currently fixed at 200px width which takes too much space on a 375px mobile screen. Collapsing it to an icon that expands on tap saves critical horizontal space while keeping search accessible.
Output: Updated Header.tsx with collapsible search and responsive view toggle.
</objective>

<execution_context>
@~/.claude/skills/create-plans/workflows/execute-phase.md
@~/.claude/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/mobile-responsive/ROADMAP.md
@frontend/src/components/layout/Header.tsx
@frontend/src/styles/explorer.css
@frontend/src/hooks/useMobileBreakpoint.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add collapsible search to Header.tsx</name>
  <files>frontend/src/components/layout/Header.tsx</files>
  <action>
  1. Import `useState` from React (add to existing import):
     ```typescript
     import { useEffect, useState } from 'react';
     ```

  2. Inside the component function, add local state for search expansion:
     ```typescript
     const [mobileSearchOpen, setMobileSearchOpen] = useState(false);
     ```

  3. Replace the search box rendering with a mobile-aware version:
     ```tsx
     {/* Search */}
     {isMobile ? (
         mobileSearchOpen ? (
             <div className="search-box mobile-search-expanded">
                 <Search size={16} className="text-muted" />
                 <input
                     type="text"
                     placeholder="Search..."
                     value={searchQuery}
                     onChange={(e) => setSearchQuery(e.target.value)}
                     autoFocus
                     onBlur={() => {
                         if (!searchQuery) {
                             setMobileSearchOpen(false);
                         }
                     }}
                 />
                 <button
                     className="nav-btn"
                     onClick={() => {
                         setSearchQuery('');
                         setMobileSearchOpen(false);
                     }}
                     style={{ width: '24px', height: '24px' }}
                 >
                     <X size={14} />
                 </button>
             </div>
         ) : (
             <button
                 className="nav-btn"
                 onClick={() => setMobileSearchOpen(true)}
                 title="Search"
             >
                 <Search size={18} />
             </button>
         )
     ) : (
         <div className="search-box ml-auto">
             <Search size={16} className="text-muted" />
             <input
                 type="text"
                 placeholder="Search..."
                 value={searchQuery}
                 onChange={(e) => setSearchQuery(e.target.value)}
             />
         </div>
     )}
     ```

  4. Import `X` from lucide-react (add to existing imports if not already there):
     ```typescript
     import { ChevronRight, ChevronUp, Search, LayoutGrid, List, Home, Menu, X } from 'lucide-react';
     ```

  This creates a pattern where:
  - Mobile: shows a search icon button → tapping it expands a full-width search bar → blurring or pressing X collapses it back
  - Desktop: unchanged full search bar
  </action>
  <verify>Run `cd frontend && npx tsc --noEmit` to confirm no type errors</verify>
  <done>Search collapses to icon on mobile, expands on tap, desktop unchanged, type check passes</done>
</task>

<task type="auto">
  <name>Task 2: Add mobile search and view toggle CSS</name>
  <files>frontend/src/styles/explorer.css</files>
  <action>
  Inside the existing `@media (max-width: 768px)` block in explorer.css, add:

  ```css
      /* Search: expanded mobile state takes remaining space */
      .search-box.mobile-search-expanded {
          flex: 1;
          width: auto;
          min-width: 0;
      }

      /* Hide the fixed-width search box default on mobile */
      .search-box:not(.mobile-search-expanded) {
          width: auto;
      }

      /* View toggle: slightly smaller on mobile */
      .view-toggle-btn {
          width: 32px;
          height: 32px;
      }

      /* Navigation buttons: ensure touch-friendly size */
      .nav-btn {
          min-width: 36px;
          min-height: 36px;
      }
  ```

  This ensures:
  - The expanded search takes available space without breaking layout
  - View toggle buttons are touch-friendly (32px)
  - Nav buttons meet minimum touch target size
  </action>
  <verify>Run `cd frontend && npm run build` to verify build succeeds</verify>
  <done>Mobile search CSS exists, touch targets sized correctly, build passes</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `cd frontend && npx tsc --noEmit` passes
- [ ] `cd frontend && npm run build` passes
- [ ] Mobile search collapses to icon
- [ ] Tapping search icon expands search bar
- [ ] Blurring empty search bar collapses it
- [ ] X button clears search and collapses
- [ ] Desktop search bar unchanged
- [ ] Touch targets adequately sized
</verification>

<success_criteria>
- Search icon-toggle pattern works on mobile
- No header overflow on any mobile viewport
- Desktop behavior completely unaffected
- Touch targets >= 36px minimum
- Build and type check pass
</success_criteria>

<output>
After completion, create `.planning/mobile-responsive/phases/03-header-mobile/03-02-SUMMARY.md`
</output>
